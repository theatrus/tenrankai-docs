# Tenrankai Configuration for Marketing & Documentation Site

[server]
host = "127.0.0.1"
port = 3000

[app]
log_level = "info"
name = "Tenrankai - High-Performance Photo Gallery Server"
cookie_secret = "change-me-in-production-use-a-long-random-string"
base_url = "https://tenrankai.com"

[templates]
# Cascade: use tenrankai-dot-com customizations first, fall back to main templates
directories = ["templates", "../../tenrankai/templates"]

[static_files]
# Cascade: use tenrankai-dot-com customizations first, fall back to main static files
directories = ["static", "../../tenrankai/static"]

# Main demo gallery showcasing Tenrankai's capabilities
[[galleries]]
name = "main"
url_prefix = "/gallery"
source_directory = "photos"
cache_directory = "cache/gallery"
images_per_page = 24
new_threshold_days = 30
pregenerate_cache = true  # Pre-generate for better demo experience
cache_refresh_interval_minutes = 120
jpeg_quality = 85
webp_quality = 85.0
copyright_holder = "Tenrankai Project"  # Per-gallery copyright holder (NEW: moved from [app] section)
image_indexing = "filename"  # Options: filename, sequence, unique_id (NEW)

# Use default templates
gallery_template = "modules/gallery.html.liquid"
image_detail_template = "modules/image_detail.html.liquid"

# NEW: Role-based permissions (replaces old hide_location_from_public, approximate_dates_for_public, etc.)
[galleries.permissions]
# For this demo gallery, we'll show everything to the public
public_role = "demo_viewer"
default_authenticated_role = "demo_viewer"

# Define a custom role that shows all features for the demo
[galleries.permissions.roles.demo_viewer]
permissions = [
    "can_view",
    "can_browse_folders",
    "can_see_metadata",
    "can_see_exact_dates",
    "can_see_location",
    "can_see_technical_details",
    "can_download_thumbnail",
    "can_download_gallery_size",
    "can_download_medium",
    "can_download_large",
    "can_read_metadata",      # NEW: Enable metadata reading for comments, picks, tags
    "can_use_zoom"           # NEW: Enable zoom functionality
]

# Image size configurations
[galleries.thumbnail]
width = 300
height = 300

[galleries.gallery_size]
width = 800
height = 800

[galleries.medium]
width = 1200
height = 1200

[galleries.large]
width = 1600
height = 1600

# Gallery preview settings
[galleries.preview]
max_images = 6
max_depth = 3
max_per_folder = 2

# Documentation posts system
[[posts]]
name = "docs"
source_directory = "posts/docs"
url_prefix = "/docs"
posts_per_page = 20
refresh_interval_minutes = 30  # Auto-refresh for live documentation updates

# Use default templates
index_template = "modules/posts_index.html.liquid"
post_template = "modules/post_detail.html.liquid"

# Blog posts system
[[posts]]
name = "blog"
source_directory = "posts/blog"
url_prefix = "/blog"
posts_per_page = 10
refresh_interval_minutes = 60

# Use default templates
index_template = "modules/posts_index.html.liquid"
post_template = "modules/post_detail.html.liquid"

# Optional: Email configuration for user registration and notifications
# [email]
# provider = "null"  # Use null provider for development (logs emails instead of sending)
# from_address = "noreply@tenrankai.com"
# 
# # For production, use SMTP:
# # provider = "smtp"
# # from_address = "noreply@tenrankai.com"
# # smtp_host = "smtp.gmail.com"
# # smtp_port = 587
# # smtp_username = "your-email@gmail.com"
# # smtp_password = "your-app-password"

# Note: To enable authentication and WebAuthn/Passkey support:
# 1. Add user_database = "users.db" to the [app] section
# 2. Ensure base_url is set with a valid hostname
# WebAuthn will automatically use the hostname from base_url as the RP ID

# Optional: Example of a portfolio gallery with clean URLs
# [[galleries]]
# name = "portfolio"
# url_prefix = "/examples/portfolio"
# source_directory = "photos/portfolio-example"
# cache_directory = "cache/portfolio"
# images_per_page = 20
# jpeg_quality = 90
# webp_quality = 90.0
# copyright_holder = "Your Name"
# image_indexing = "sequence"  # Clean URLs like /1, /2 instead of filenames
# 
# [galleries.permissions]
# public_role = "viewer"  # Limited public access
# default_authenticated_role = "member"
# 
# [galleries.thumbnail]
# width = 400
# height = 400
# 
# [galleries.gallery_size]
# width = 1000
# height = 1000

# Optional: Example of a family gallery with privacy settings
# [[galleries]]
# name = "family"
# url_prefix = "/examples/family"
# source_directory = "photos/family-example"
# cache_directory = "cache/family"
# images_per_page = 50
# new_threshold_days = 7
# copyright_holder = "The Smith Family"
# 
# [galleries.permissions]
# public_role = "viewer"  # Limited public access
# default_authenticated_role = "family"  # Family members get full access

